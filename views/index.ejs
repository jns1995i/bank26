<% layout('design') %>
<style>
  @media (max-width: 900px) {
    .login {
      flex-direction: column;
      div {
        padding-bottom: 0;
        width: 100%;
      }
      form {
        width: 100%;
        padding-top: 0;
        padding: 15px;
      }
    }
    #getStat {
      width: 100% !important;
      flex-direction: column;
      padding: 15px;
      gap: 10px;
      margin-bottom: 10px;
      p {
        text-align: center;
        width: 100%;
      }
    }
    .rightF {
      width: 100%;
    }
    .leftF {
      width: 100%;
    }
  }
</style>

<section class="padding0 corner10 col">
  <div class="height0 gap15 corner20 login colorPrimary width100 padding10 relative justifyEnd col liquidX">
    <div class="height0 col padding5 bgWhite colorPrimary corner15">
      <div class="height0 padding15 corner15 justifyBetween col gap10" id="getStat">
        <img src="/images/gold.png" alt="" class="h60 hidden" style="filter:brightness(2); transform: rotate(-10deg);">
        <p class="rem16 textCenter textBalance">New here? Request your first document now!</p>
        <a href="/rg" class="nav corner10 gnav width100"><span class="str500">Get started here</span></a>
      </div>
    </div>
    <form action="/login" method="POST" class="colorPrimary gap5 width100 padding20 bgWhite" id="loginForm">
      <div class="height0 col">
        <% if (error) { %>
          <p class="rem16 str500 wcT textCenter textWrap">Already registered? Sign In here</p>
          <span style="color: red;" class="bgRed100"><%= error %></span>
        <% } else { %>
          <p class="rem16 str400 wcT textCenter textWrap">Already registered? Sign In here</p>
        <% } %>
      </div>

      <div class="field marginTop5">
        <label for="username">Username</label>
        <input type="text" id="username" name="username" required placeholder="Enter your username">
      </div>

      <div class="field password width100">
        <label for="password">Password</label>
        <input type="password" id="password" name="password" required placeholder="Enter your password">
        <span class="showPass" id="showPass" style="cursor: pointer;">show</span>
      </div>

      <div class="justifyBetween" id="MathRecaptcha">
        <input type="text" id="num1" class="width20 textCenter size14" readonly>
        <div class="width10 textCenter str500" style="width: 10%;"><i class="fas fa-plus"></i></div>
        <input type="text" id="num2" class="width20 textCenter size14" readonly>
        <div class="width10 textCenter str500" style="width: 10%;"><i class="fas fa-equals"></i></div>
        <input type="text" id="answer" class="width20 textCenter str500" required>
        <div class="height0 width20 gap5 justifyEnd" style="width: 20%;">
          <a href="#" class="nav cnav" id="reset"><i class="fas fa-rotate"></i></a>
        </div>
      </div>

      <div class="bgRed100 hidden" id="warning20">Please fill the correct value!</div>
      <div class="field padding5">
        <button type="submit" class="nav pnav width100">Sign In</button>
      </div>

      <a href="/fg" class="blue size12">Forgot Password</a>
    </form>
    <a href="/login2" class="nav absolute left0 top0 opacity0">none</a>
  </div>
  <br>
</section>


<div class="height0 padding15 gap10 width100 justifyStart liquidX">
    <div class="height0 padding10 border0 borderRadius10 alignStart width50 col gap10 relative">
        <p class="rem18 gap10 alignCenter">Need Help?</p>
        <p class="rem11 gap10 alignCenter textBalance">Watch the tutorial or click below.</p>
        <a href="/ins" class="nav liquid">Learn More <i class="fas fa-chevron-right"></i></a>
        <a href="#" class="nav cnav disabled opacity1 absolute right5 bottom5 scale4"><i class="fas fa-question-circle"></i></a>
    </div>
    <video autoplay muted loop playsinline controls class="width50 cornerRem1" style="opacity: 1;"><source src="/images/video.mp4" type="video/mp4"></video>
</div>


  <script>
  function generateRandomNumbers() {
    const num1 = Math.floor(Math.random() * 10) + 1; // 1-10
    const num2 = Math.floor(Math.random() * 10) + 1;
    document.getElementById('num1').value = num1;
    document.getElementById('num2').value = num2;
    const answerInput = document.getElementById('answer');
    answerInput.value = '';
    answerInput.style.color = 'black';
    answerInput.style.fontWeight = 'bold';
    answerInput.style.fontSize = '14px';
    answerInput.dataset.correct = num1 + num2;

    // Hide warning on reset
    document.getElementById('warning20').classList.add('hidden');
  }

  // Check answer on input
  document.getElementById('answer').addEventListener('input', function() {
    // Only allow numbers
    this.value = this.value.replace(/[^0-9]/g, '');
    
    const correct = Number(this.dataset.correct);
    const user = Number(this.value);
    const warning = document.getElementById('warning20');
    
    if (this.value === '') {
      this.style.color = 'black';
      warning.classList.add('hidden');
    } else if (user === correct) {
      this.style.color = 'blue';
      warning.classList.add('hidden');
    } else {
      this.style.color = 'red';
      warning.classList.remove('hidden');
    }
  });

  // Reset numbers
  document.getElementById('reset').addEventListener('click', function(e) {
    e.preventDefault();
    generateRandomNumbers();
  });

  // Initialize
  generateRandomNumbers();
  </script>


<script>
  const loginForm = document.getElementById('loginForm');
  const answerInput = document.getElementById('answer');
  const warning = document.getElementById('warning20');

  loginForm.addEventListener('submit', function(e) {
    const correct = Number(answerInput.dataset.correct);
    const userAnswer = Number(answerInput.value.trim());

    if (userAnswer !== correct) {
      e.preventDefault(); // stop form submission
      warning.classList.remove('hidden');
      answerInput.style.color = 'red';
      answerInput.focus();
    }
  });
</script>
